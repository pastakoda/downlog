# Abstract
Console PHP application to parse logs according specification in `tz/ТЗ программист PHP.DOCX`
# Build
`./build` &mdash; builds docker container, runs dependency installation and unit tests.

# Play & study

`cat intervals.txt | ./generate | ./analyze -u 90 -t 3 -m`

Analyze log stream with `./analyze` generated by `./generate` script based on parameters in `intervals.txt` . 
U can split this command chain to see result of each command execution.

`cat intervals.txt | ./generate` &mdash; generates logs. Try it on real access log instead of generator.

# Generate

`./generate` &mdash; Runs generate.php inside docker container.

You should pass  intervals description in standard input to generate access logs.
Each line of input describes one interval (see intervals.txt).

For example: 
```
0:1:0 0:1:59 95 3 100000
```
Generates `100000` lines in date range between `0:1:0` and `0:1:59` 
with `95%` access level and with response time `3`. 

# Analyze

`./analyze` &mdash; runs `analyze.php` inside docker container. Run it without parameters to see following usage info.
```
./analyze.php -u <access level> -t <response time limit> [-m]

Parse access log from standard input for inaccessible intervals according to options:

-u <access level> - percentage of acceptable accessibility

-t <response time limit> - acceptable response time in milliseconds

-m - show memory peak usage
```
# Memory usage

Sample from "Play and study" parses 400 000 lines and use 1,433Mb of memory.

# To do

- PSR
- Check sources for comments and types
- Measure memory usage - write results to doc
- Refactor generator & tests
- More tests on extremum values